
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Etiquetas - VICENTE ESPI</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="css/estilos_odoo.css">
  <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore-compat.js"></script>
</head>
<body>
  <div class="container">
    <h1>Gestión de Etiquetas - VICENTE ESPI</h1>
    <div class="modulos-container">
      <div class="modulo" onclick="crearNuevaCarpeta()">
        <h3>NUEVA CARPETA</h3>
        <p>📂</p>
      </div>
      <div class="modulo" onclick="crearNuevaEtiqueta()">
        <h3>NUEVA ETIQUETA</h3>
        <p>🏷️</p>
      </div>
    </div>

    <div id="estructura-etiquetas"></div>
  </div>

  <script>
    const firebaseConfig = {
      apiKey: "TU_API_KEY",
      authDomain: "TU_PROYECTO.firebaseapp.com",
      projectId: "TU_PROYECTO",
      storageBucket: "TU_PROYECTO.appspot.com",
      messagingSenderId: "TU_ID",
      appId: "TU_APP_ID"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    function crearNuevaCarpeta() {
      const nombre = prompt("Nombre de la carpeta:");
      if (!nombre) return;
      db.collection("vicente_espi_etiquetas").add({
        tipo: "carpeta",
        nombre: nombre,
        parent: null,
        creado: new Date()
      }).then(() => {
        alert("Carpeta creada.");
        renderEstructura();
      });
    }

    function crearNuevaEtiqueta() {
      const nombre = prompt("Nombre de la etiqueta:");
      const formato = prompt("Formato (ej. 4x, 2x):");
      if (!nombre || !formato) return;
      db.collection("vicente_espi_etiquetas").add({
        tipo: "etiqueta",
        nombre: nombre,
        formato: formato,
        parent: null,
        campos: {
          producto: "",
          lote: "",
          fecha: ""
        },
        creado: new Date()
      }).then(() => {
        alert("Etiqueta creada.");
        renderEstructura();
      });
    }

    function renderEstructura() {
      const cont = document.getElementById("estructura-etiquetas");
      cont.innerHTML = "<h3>Contenido:</h3>";
      db.collection("vicente_espi_etiquetas")
        .where("parent", "==", null)
        .orderBy("tipo")
        .get().then(snapshot => {
          snapshot.forEach(doc => {
            const data = doc.data();
            const div = document.createElement("div");
            div.className = "carpeta";
            if (data.tipo === "carpeta") {
              div.innerHTML = "📁 " + data.nombre;
            } else {
              div.innerHTML = `🏷️ ${data.nombre} - Formato: ${data.formato}`;
            }
            cont.appendChild(div);
          });
        });
    }

    renderEstructura();
  </script>
</body>
</html>
